Perfect — here’s a **clean, practical, and consolidated note** of everything from your entire Episode 21 discussion on **Promises** 👇

---

# 🧩 **Episode 21 — JavaScript Promises**

---

## 🔹 1. What is a Promise?

* A **Promise** is an **object** that represents the **eventual completion (or failure)** of an **asynchronous operation**.
* Think of it as a **container for a future value** — a placeholder until the real value arrives.

```js
const promise = new Promise((resolve, reject) => { /* async task */ });
```

---

## 🔹 2. Why Promises?

Before Promises, async code was handled using **callbacks** — leading to two major problems:

1. **Inversion of Control** – trusting another function to call your callback correctly.
2. **Callback Hell** – nested callbacks make code unreadable and hard to maintain.

### ❌ Before (Callback-based)

```js
createOrder(cart, function(orderId) {
  proceedToPayment(orderId, function(paymentInfo) {
    showOrderSummary(paymentInfo, function(balance) {
      updateWalletBalance(balance);
    });
  });
});
```

---

## 🔹 3. How Promises Fix It

### ✅ With Promises

```js
createOrder(cart)
  .then(orderId => proceedToPayment(orderId))
  .then(paymentInfo => showOrderSummary(paymentInfo))
  .then(balance => updateWalletBalance(balance))
  .catch(error => console.error(error));
```

### 🧠 Key Points:

* `.then()` attaches a callback to the Promise.
* `.catch()` handles errors.
* Each `.then()` returns a new Promise → allows **Promise chaining**.
* **Promise guarantees**: callback runs **only once** when data is ready.

---

## 🔹 4. States of a Promise

| State         | Description                           |
| ------------- | ------------------------------------- |
| **Pending**   | Initial state, operation not complete |
| **Fulfilled** | Operation completed successfully      |
| **Rejected**  | Operation failed                      |

### Example:

```js
console.log(fetch('https://api.github.com/users/alok722'));
// → Promise { <pending> }
```

---

## 🔹 5. Promise Object Internals

Each Promise has:

| Property            | Description                  |
| ------------------- | ---------------------------- |
| `[[PromiseState]]`  | pending → fulfilled/rejected |
| `[[PromiseResult]]` | The value (data or error)    |

Example when using `fetch()`:

* Initially → `PromiseState: pending`, `PromiseResult: undefined`
* After completion → `PromiseState: fulfilled`, `PromiseResult: response data`

---

## 🔹 6. Implicit vs Explicit Promises

| Type                 | Who Creates It                         | Example                                   |
| -------------------- | -------------------------------------- | ----------------------------------------- |
| **Implicit Promise** | Created automatically by a browser API | `fetch()`, `axios.get()`                  |
| **Explicit Promise** | Created manually by the developer      | `new Promise((resolve, reject) => {...})` |

### ✅ Implicit Example (`fetch`)

```js
const userPromise = fetch('https://api.github.com/users/alok722');
userPromise.then(response => response.json())
           .then(data => console.log(data));
```

### ✅ Explicit Example (Custom Function)

```js
function createOrder(cart) {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      const orderId = "ORD12345";
      resolve(orderId);
    }, 2000);
  });
}

createOrder(["shoes"]).then(orderId => proceedToPayment(orderId));
```

---

## 🔹 7. Promise Chaining (Avoid Callback Hell)

> The value returned from one `.then()` is passed to the next `.then()`.

```js
createOrder(cart)
  .then(orderId => proceedToPayment(orderId))
  .then(paymentInfo => showOrderSummary(paymentInfo))
  .then(balance => updateWalletBalance(balance))
  .catch(err => console.error("Error:", err));
```

⚠️ **Common Mistake:**
Not returning a Promise inside `.then()` breaks the chain.

---

## 🔹 8. Promise Immutability

* Once a Promise is fulfilled or rejected, its value **cannot change**.
* You can **pass** the same Promise around — but cannot mutate it.

```js
const p = fetch("https://api.github.com");
p.then(res => console.log(res)); // Safe — p can’t be modified
```

---

## 🔹 9. Relationship Between Promises & `fetch()`

| Concept                 | Description                                            |
| ----------------------- | ------------------------------------------------------ |
| **Promise (ES6 2015)**  | JavaScript language feature for async operations       |
| **fetch() (2015–2016)** | Web API built **on top of Promises** for HTTP requests |

### Example:

```js
fetch("https://api.github.com/users/alok722")
  .then(res => res.json())
  .then(data => console.log(data))
  .catch(err => console.error(err));
```

---

## 🔹 10. Timeline Overview

| Year      | Event                                          |
| --------- | ---------------------------------------------- |
| Pre-2015  | Async handled via **callbacks**                |
| 2015      | **Promises introduced** (ES6)                  |
| 2015–2016 | **`fetch()` introduced**, built using Promises |

---

## 🧭 Quick Summary

| Concept          | Key Idea                                      |
| ---------------- | --------------------------------------------- |
| Promise          | Object representing a future value            |
| States           | pending → fulfilled/rejected                  |
| then()           | Attaches success handler                      |
| catch()          | Attaches failure handler                      |
| finally()        | Runs always (cleanup)                         |
| fetch()          | Web API returning a Promise                   |
| Explicit Promise | Created manually with `new Promise()`         |
| Implicit Promise | Returned automatically by APIs like `fetch()` |

---

## 🎯 Interview Nuggets

1. **What is a Promise?**
   → A placeholder for a future value — represents the result of an async operation.

2. **Why use Promises?**
   → To avoid inversion of control and callback hell.

3. **Are Promises synchronous or asynchronous?**
   → The callback in `.then()` is always executed asynchronously (after current call stack).

4. **Can a Promise be reused?**
   → Yes, but the result is immutable once resolved/rejected.

---

Would you like me to give you a **visual diagram (DOM-style)** showing how `Promise`, `fetch`, and async flow connect (like a timeline or flow of execution)?
